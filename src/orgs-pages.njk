---
layout: layouts/base.njk
pagination:
    data: orgs.hits.hits
    size: 1
    alias: org
permalink: "{{ org._source.objectID | slug }}/"
---

{%- from "system/component.njk" import component -%}

<header class="mb-3 col-span-12 md:col-span-6">
  <h1 class="mb-12 text-xl md:text-3xl font-light">
    {% if org._source.policy.supported_policy === true %}Put OA policy into practice at {% else %}Advance OA at {% endif %}
    <br>
    <strong class="font-semibold">{{ org._source.name }}</strong>
    <br>
  </h1>
  {# TODO: get logos #}
  {# <figure class="block border border-neutral-700 h-36 w-96 p-6 flex"><p class="self-center m-auto">[LOGO WILL BE HERE]</p></figure> #}

  {# Download in CSV #}
  <form method="get" class="w-1/2" id="download_csv" action="">
    <input type="hidden" id="size" name="size" value="all">
    <label for="email" class="mb-2 block text-base text-neutral-800">
      Get data by email in CSV
      {{ component("tooltip", {
        msg: "Enter your email address to receive a link to a CSV for download. <strong>We do not save email addresses or use them for any purpose</strong> other than sending you the CSV file containing OAreport data when you request it."
      }) }}
    </label>
    <div class="my-1 flex rounded-sm shadow-sm">
      <div class="relative flex items-stretch flex-grow focus-within:z-10">
        <div class="absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none">
          {% icon_small "mail" %}
        </div>
        <input type="email" name="email" id="email" class="focus:ring-carnation-500 focus:border-carnation-500 block w-full rounded-none rounded-l-md pl-10 sm:text-sm shadow-md border-0 js-csv_email_input" placeholder="you@example.com" required>
      </div>
      <button type="submit" class="-ml-px relative inline-flex items-center space-x-2 px-4 py-2 text-sm font-medium rounded-r-md text-white bg-neutral-900 hover:bg-carnation-500 hover:text-neutral-900 hover:border-carnation-500 focus:outline-none focus:ring-1 focus:ring-carnation-500 focus:border-carnation-500 focus:border-carnation-500 duration-500 shadow-md border-0 js-csv_email_button">
        Send CSV
      </button>
    </div>
    <input type="hidden" id="download-form-q" name="q" value="">
    <input type="hidden" id="download-form-include" name="include" value="">
    <p class="leading-5 text-xs text-neutral-600" id="csv_email_msg"></p>
  </form>
</header>

<nav class="col-span-12 md:col-span-6 md:text-right">
  <p class="mb-3">
    Your OAreport <span id="insights_range">since the start of 2022</span>
    <br> <span class="text-neutral-600"><span id="start_date"></span> — <span id="end_date"></span></span>
  </p>
  {# Preset date filters #}
  <h2 class="sr-only">Quick date filters</h2>
  {{ component("pill", {
    id: "start-year",
    txt: "Since start of year"
  }) }}
</nav>

<section class="col-span-12 grid grid-cols-12 gap-3 lg:gap-6 top-0 mb-2 pt-2 bg-[#F4F0F0]">
  <div class="col-span-12 grid grid-cols-12 gap-3">
    <header class="col-span-12 md:col-span-6">
      <h2 class="mb-3 text-lg leading-6">
        <span class="block font-medium text-neutral-900">
          Insights
          {{ component("tooltip", {
            msg: "The <em>Insights</em> section provides a quick overview of your organization’s Open Access statistics. Our data sources are listed on our <a href='https://oa.works/' target='_blank' class='underline'>infrastructure page</a>."
          }) }}
        </span>
      </h2>
    </header>

    <dl class="col-span-12 mb-6 grid grid-cols-1 gap-3 lg:gap-6 sm:grid-cols-2 lg:grid-cols-3">
      <div class="relative bg-white py-5 px-4 sm:py-6 sm:px-6 drop-shadow-lg md:rounded-lg overflow-hidden" id="compliance">
        <dt>
          <div class="absolute bg-carnation-500 text-white rounded-md p-6">
            {% icon "check-circle" %}
          </div>
          <p class="ml-24 mb-2 text-base font-medium text-gray-500 truncate">
            Policy-compliant articles
            <sup id="org_oa_policy">{% icon_small "help-circle" %}</sup>
          </p>
        </dt>
        <dd class="ml-24 flex items-baseline">
          <p class="text-4xl font-semibold text-gray-900">
            <span id="percent_compliant">00%</span>
          </p>
          <p class="ml-2 text-sm font-medium text-neutral-600">
            <span id="articles_compliant">000</span>
          </p>
        </dd>
      </div>

      <div class="relative bg-white py-5 px-4 sm:py-6 sm:px-6 drop-shadow-lg md:rounded-lg overflow-hidden">
        <dt>
          <div class="absolute bg-carnation-500 text-white rounded-md p-6">
            {% icon "unlock" %}
          </div>
          <p class="ml-24 mb-2 text-base font-medium text-gray-500 truncate">
            Open Access articles
            {{ component("tooltip", {
              msg: "The total number of articles that are currently Open Access, either because the version of record is Open Access (“gold”, “diamond”, or “hybrid” Open Access) or because the article was preprinted or been made available through self-archiving (“green” Open Access)."
            }) }}
          </p>
        </dt>
        <dd class="ml-24 flex items-baseline">
          <p class="text-4xl font-semibold text-gray-900">
            <span id="percent_oa">00%</span>
          </p>
          <p class="ml-2 text-sm font-medium text-neutral-600">
            <span id="articles_oa">000</span>
          </p>
        </dd>
      </div>

      <div class="relative bg-white py-5 px-4 sm:py-6 sm:px-6 drop-shadow-lg md:rounded-lg overflow-hidden">
        <dt>
          <div class="absolute bg-carnation-500 text-white rounded-md p-6">
            {% icon "file-text" %}
          </div>
          <p class="ml-24 mb-2 text-base font-medium text-gray-500 truncate">
            Articles published
            {{ component("tooltip", {
              msg: "The total number of articles published by grantees or authors at your organization."
            }) }}
          </p>
        </dt>
        <dd class="ml-24 flex items-baseline">
          <p class="text-4xl font-semibold text-gray-900">
            <span id="articles">000</span>
          </p>
        </dd>
      </div>
    </dl>

    <div class="col-span-12 mb-6 grid grid-cols-12 gap-3 lg:gap-6">
      {# TODO: Filter by date #}
      {# <section>
        <h2 class="sr-only">Filter by date</h2>
        <form onsubmit="changeDateRange()" method="get" id="change_date_range">
          <div class="flex items-end mb-3">
            <fieldset class="mr-6">
              <label for="report-start-date" class="mb-2 block text-base text-neutral-800">From</label>
              <input type="date" min="2021-01-01" name="report-start-date" id="report_start_date" class="focus:ring-carnation-500 focus:border-carnation-500 block w-full sm:text-sm shadow-md rounded-md border-0" required>
            </fieldset>
            <fieldset class="mr-6">
              <label for="report-end-date" class="mb-2 block text-base text-neutral-800">To</label>
              <input type="date" min="2021-01-01" name="report-start-date" id="report_end_date" class="focus:ring-carnation-500 focus:border-carnation-500 block w-full sm:text-sm shadow-md rounded-md border-0" required>
            </fieldset>
            <button type="submit" class="block px-4 py-2 text-sm font-medium rounded-md text-white bg-neutral-900 hover:bg-carnation-500 hover:text-neutral-900 hover:border-carnation-500 focus:outline-none focus:ring-1 focus:ring-carnation-500 focus:border-carnation-500 focus:border-carnation-500 duration-500 shadow-md border-0 h-fit whitespace-nowrap">
              Filter by dates
            </button>
          </div>
        </form>
      </section> #}

    </div>
  </div>
</section>

<section class="col-span-12" id="strategies">
  <h2 class="mb-5 text-lg leading-6 font-medium text-neutral-900">
    Strategies
    {{ component("tooltip", {
      msg: "The <em>Strategy</em> section provides actionable steps for making more of your articles Open Access."
    }) }}
  </h2>
  <div class="grid grid-cols-12 gap-3 lg:gap-6 md:gap-12">
    <header class="md:mb-12 col-span-12 lg:col-span-4">
      <div class=" lg:sticky lg:top-3">
        <p class="mb-3 text-base font-normal text-neutral-700 lg:duration-500 js-label_text_toggle"><span class="block mb-2 text-carnation-500 js-icon_toggle">{% icon_small "archive" %}</span> Self-archive articles</p>
        <h3 class="font-semibold text-xl md:text-4xl mb-3 md:mb-6">Ask authors to share their Author Accepted Manuscript</h3>
        <p class="text-xs md:text-base">Send emails to authors to request that they make the AAMs of their articles available in an Open Access repository.</p>
      </div>
    </header>
    <div class="pt-3 md:pt-6 col-span-12 lg:col-span-8 border-t sm:border-0">
      <div class="grid grid-cols-12 gap-3 lg:gap-6 flex justify-between">
        <div class="col-span-12 md:col-span-6">
          <p class="mb-1 text-neutral-900 text-lg font-semibold leading-6">
            <span id="total_actions">00</span> actions prepared</span>
            {{ component("tooltip", {
              msg: "This number represents the number of articles that have the ability to be made open access for free but are currently behind a paywall. In these cases, the publishers allow for self-archiving an author accepted manuscript version of the article in a repository."
            }) }}
          </p>
          <p class="text-neutral-700 text-base">Showing the <span id="latest_actions">100</span> most recent articles</p>
        </div>
        {# TODO: think more about the potential percentage #}
        {# <div class="col-span-12 md:col-span-6 md:text-right">
          <p class="mb-1 font-semibold text-neutral-900 text-lg leading-6">If all articles are self-archived:</p>
            <p class="text-neutral-700 text-base">&uarr; <span class="sr-only">Increase</span> OA% up to <span id="can_archive_percent_oa"></span>%</p>
        </div> #}
      </div>

      <div class="my-8 overflow-hidden sm:-mx-6 md:mx-0 md:rounded-lg drop-shadow-lg">
        <table class="divide-y divide-neutral-300 table-fixed w-full">
          <thead class="bg-neutral-800 text-white">
            <tr>
              <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold w-6/12">Article</th>
              <th scope="col" class="hidden px-3 py-3.5 text-left text-sm font-semibold w-4/12 sm:table-cell">Corresponding author</th>
              <th scope="col" class="text-sm font-semibold py-3.5 pl-3 pr-4 w-2/12">
                Open draft
                {{ component("tooltip", {
                  msg: "This will open a preset message in your email client. If you make any changes to the email, it will not be saved here."
                }) }}
              </th>
            </tr>
          </thead>
          <tbody class="divide-y divide-neutral-200 bg-white" id="can_archive_list"></tbody>
        </table>
      </div>
    </div>
  </div>
</section>
